describe(as.numeric(Study3$age))
Study3$age <- (as.Date('3/15/2019',format='%m/%d/%Y') - Study3$DOB)/365
#1/31/2021
describe(as.numeric(Study3$age))
Study3$age <- (as.Date('3/31/2019',format='%m/%d/%Y') - Study3$DOB)/365
#1/31/2021
describe(as.numeric(Study3$age))
load("~/Documents/GitHub/COVIDiSTRESS2_Stress/Stress_aligned.RData")
table(data.filtered$residing_country)
test<-table(data.filtered$residing_country)
length(test)
length(table(data.filtered$residing_country))
label(test)
labels(test)
View(labels(test))
View(labels(test[[1]]))
View(labels(test)[[1]])
load("~/Documents/GitHub/COVIDiSTRESS2_Stress/R1/Big_Picture/big.pss.RData")
hypothesis(pss.2,'sps_identity>0')
library(brms)
hypothesis(pss.2,'sps_identity>0')
load("~/Documents/GitHub/COVIDiSTRESS2_Stress/R1/Big_Picture/big.res.RData")
# sps
hypothesis(pss.1,'pss_sps>0') #0.22      0.02     0.19     0.25        Inf         1    *
hypothesis(pss.1,'sps_identity>0')
# bf
bf.pss.2.0 <- bayes_factor(pss.2,pss.0,log=T)
load("~/Documents/GitHub/COVIDiSTRESS2_Stress/R1/Big_Picture/big.pss.RData")
# bf
bf.pss.2.0 <- bayes_factor(pss.2,pss.0,log=T)
bf.pss.2.0
# hypothesis testing
# primary
hypothesis(pss.2, 'pss_primary_stressor_avg >0') #0.14      0.02     0.11     0.17        Inf         1    *
model.mediator.f <- bf(sps ~  gender + education + work_location + age+
SSS_faml+ relationship_status)
model.pss.f <- bf(pss ~
gender + education + work_location + age+
SSS_faml+ relationship_status)
pss.f <- brms::brm( model.pss.f+model.mediator.f+set_rescor(F) ,
data=data.filtered, family = gaussian(),
cores=4,chains=4, save_pars = save_pars(all = T),
sample_prior ='yes', seed=1660415,prior=prior.coef)
bf.pss.2.f <- bayes_factor(pss.2,pss.f,log=T)
bf.pss.2.f
save.image("~/Documents/GitHub/COVIDiSTRESS2_Stress/R1/Big_Picture/big.pss.RData")
load("~/Documents/GitHub/COVIDiSTRESS2_Stress/R1/Big_Picture/big.res.RData")
bf.pss.1.0
model.mediator.f <- bf(sps ~ identity+ gender + education + work_location + age+
SSS_faml+ relationship_status
)
model.pss.f <- bf(pss ~ primary_stressor_avg + primary_stressor_avg*sps +
secondary*identity + secondary*sps +
gender + education + work_location + age+
SSS_faml+ relationship_status)
pss.f <- brms::brm(model.mediator.f + model.pss.f + set_rescor(F),
data=data.filtered, family = gaussian(),
cores=4,chains=4, save_pars = save_pars(all = T),
sample_prior ='yes', seed=1660415,prior=prior.coef)
bf.pss.1.0 <- bayes_factor(pss.1,pss.0,log=T)
bf.pss.1.2 <- bayes_factor(pss.1,pss.2,log=T)
bf.pss.1.2
bf.pss.1.f<- bayes_factor(pss.1,pss.f,log=T)
bf.pss.1.f
# bfs
bf.pss.1.0 <- bayes_factor(pss.1,pss.0,log=T)
model.mediator.0 <- bf(sps ~  gender + education + work_location + age+
SSS_faml+ relationship_status+
(1|residing_country))
model.pss.0 <- bf(pss ~
gender + education + work_location + age+
SSS_faml+ relationship_status+
(1|residing_country))
pss.0 <- brms::brm( model.pss.0+model.mediator.0+set_rescor(F) ,
data=data.filtered, family = gaussian(),
cores=4,chains=4, save_pars = save_pars(all = T),
sample_prior ='yes', seed=1660415,prior=prior.coef)
# bfs
bf.pss.1.0 <- bayes_factor(pss.1,pss.0,log=T)
bf.pss.1.0
save.image("~/Documents/GitHub/COVIDiSTRESS2_Stress/R1/Big_Picture/big.res.RData")
load("~/Documents/GitHub/COVIDiSTRESS2_Stress/R1/Big_Picture/big.pss.RData")
model.mediator.f <- bf(sps ~  identity+gender + education + work_location + age+
SSS_faml+ relationship_status)
model.pss.f <- bf(pss ~ primary_stressor_avg + primary_stressor_avg*sps +
secondary*identity + secondary*sps +
gender + education + work_location + age+
SSS_faml+ relationship_status)
pss.f <- brms::brm( model.pss.f+model.mediator.f+set_rescor(F) ,
data=data.filtered, family = gaussian(),
cores=4,chains=4, save_pars = save_pars(all = T),
sample_prior ='yes', seed=1660415,prior=prior.coef)
bf.pss.2.f <- bayes_factor(pss.2,pss.f,log=T)
bf.pss.2.f
save.image("~/Documents/GitHub/COVIDiSTRESS2_Stress/R1/Big_Picture/big.pss.RData")
# trust examination
library(lmerTest)
library(brms)
# load data
load('../Vaccine_H2.RData')
setwd("~/Documents/GitHub/COVIDiSTRESS2_Vaccine/R2")
# load data
load('../Vaccine_H2.RData')
library(psych)
# descriptive
describe(data.filtered$trust_6,group=data.filtered$residing_country)
# descriptive
describeBy(data.filtered$trust_6,group=data.filtered$residing_country)
# load data
load((file='Vaccine_aligned.RData'))
# load data
load((file='../Vaccine_aligned.RData'))
# descriptive
describeBy(data.filtered$trust_6,group=data.filtered$residing_country)
load('../Vaccine_H2.RData')
table(data$residing_country)
table(data.filtered$residing_country)
table.countries <- table(data.filtered$residing_country)
countries <- labels(table.countries)[[1]]
n.countries <- length(countries)
# test each
# frequentist
for (i in 1:n.countries){
current <- data.filtered[data.filtered$residing_country == countries[[i]],]
}
# test each
# frequentist
for (i in 1:n.countries){
current <- data.filtered[data.filtered$residing_country == countries[[i]],]
current.lm <- lm(vx ~ trust_6+gender + education + work_location + age+
SSS_faml+ relationship_status, data=current)
}
current.lm
summary(current.lm)
nrow(current)
library(effectsize)
eta_squared(current.lm)
current.eta<-eta_squared(current.lm)
current.eta
current.eta[1]
current.eta[2]
current.eta[2,1]
current.eta[1,2
current.eta[1,2]
# test each
# frequentist
etas <- matrix(nrow=n.countries)
for (i in 1:n.countries){
current <- data.filtered[data.filtered$residing_country == countries[[i]],]
current.lm <- lm(vx ~ trust_6+gender + education + work_location + age+
SSS_faml+ relationship_status, data=current)
current.eta<-eta_squared(current.lm)
etas<-current.eta[1,2]
}
etas
# test each
# frequentist
etas <- matrix(nrow=n.countries)
for (i in 1:n.countries){
current <- data.filtered[data.filtered$residing_country == countries[[i]],]
current.lm <- lm(vx ~ trust_6+gender + education + work_location + age+
SSS_faml+ relationship_status, data=current)
current.eta<-eta_squared(current.lm)
etas[i]<-current.eta[1,2]
}
etas
# test each
# frequentist
etas <- matrix(nrow=n.countries)
mean.trust <- matrix(nrow=n.countries)
# load data
load((file='../Vaccine_aligned.RData'))
# descriptive
describeBy(data.filtered$trust_6,group=data.filtered$residing_country)
table.countries <- table(data.filtered$residing_country)
countries <- labels(table.countries)[[1]]
n.countries <- length(countries)
# test each
# frequentist
etas <- matrix(nrow=n.countries)
mean.trust <- matrix(nrow=n.countries)
sd.trust <- matrix(nrow=n.countries)
for (i in 1:n.countries){
current <- data.filtered[data.filtered$residing_country == countries[[i]],]
current.lm <- lm(vx ~ trust_6+gender + education + work_location + age+
SSS_faml+ relationship_status, data=current)
current.eta<-eta_squared(current.lm)
etas[i]<-current.eta[1,2]
mean.trust[i] <- mean(current$trust_6, na.rm=T)
sd.trust[i] <- sd(current$trust_6,na.rm=T)
}
etas
mean.trust
sd.trust
corr.test(etas,mean.trust)
corr.test(etas,sd.trust)
cbind(etas,sd.trust)
sd.median <- median(sd.trust)
sd.median
current.lm
summary(current.lm)
nrow(current)
table(data.filtered$residing_country)
sd.median <- median(sd.trust)
data.filtered$sd <- 0
# high low
for (i in 1:n.countries){
if (sd.trust[i]>=sd.median){
data.filtered[data.filtered$residing_country == countries[i],'sd'] <- 1
}else{
data.filtered[data.filtered$residing_country == countries[i],'sd'] <- 0
}
}
table(data.filtered$sd)
# high
lm.high <- lm(vx ~ trust_6+gender + education + work_location + age+
SSS_faml+ relationship_status, data=data.filtered[data.filtered$sd == 1,])
# low
lm.low <- lm(vx ~ trust_6+gender + education + work_location + age+
SSS_faml+ relationship_status, data=data.filtered[data.filtered$sd == 0,])
summary(lm.high)
summary(lm.low)
load('../Vaccine_H2.RData')
# load data
load((file='../Vaccine_aligned.RData'))
# descriptive
describeBy(data.filtered$trust_6,group=data.filtered$residing_country)
load('../Vaccine_H2.RData')
table.countries <- table(data.filtered$residing_country)
countries <- labels(table.countries)[[1]]
n.countries <- length(countries)
# test each
# frequentist
etas <- matrix(nrow=n.countries)
mean.trust <- matrix(nrow=n.countries)
sd.trust <- matrix(nrow=n.countries)
for (i in 1:n.countries){
current <- data.filtered[data.filtered$residing_country == countries[[i]],]
current.lm <- lm(vx ~ trust_6+gender + education + work_location + age+
SSS_faml+ relationship_status, data=current)
current.eta<-eta_squared(current.lm)
etas[i]<-current.eta[1,2]
mean.trust[i] <- mean(current$trust_6, na.rm=T)
sd.trust[i] <- sd(current$trust_6,na.rm=T)
}
sd.median <- median(sd.trust)
sd.median
corr.test(cbind(etas,mean.trust,sd.trust))
corr.test((etas,mean.trust))
corr.test(etas,mean.trust)
corr.test(etas,sd.trust)
sd.median <- median(sd.trust)
data.filtered$sd <- 0
# high low
for (i in 1:n.countries){
if (sd.trust[i]>=sd.median){
data.filtered[data.filtered$residing_country == countries[i],'sd'] <- 1
}else{
data.filtered[data.filtered$residing_country == countries[i],'sd'] <- 0
}
}
# high
lm.high <- lm(vx ~ trust_6+gender + education + work_location + age+
SSS_faml+ relationship_status, data=data.filtered[data.filtered$sd == 1,])
# low
lm.low <- lm(vx ~ trust_6+gender + education + work_location + age+
SSS_faml+ relationship_status, data=data.filtered[data.filtered$sd == 0,])
summary()
summary(lm.high)
summary(lm.low)
# high
lm.high <- lmer(vx ~ trust_6+gender + education + work_location + age+
SSS_faml+ relationship_status + (1+trust_6|residing_country), data=data.filtered[data.filtered$sd == 1,])
# low
lm.low <- lmer(vx ~ trust_6+gender + education + work_location + age+
SSS_faml+ relationship_status + (1+trust_6|residing_country),
data=data.filtered[data.filtered$sd == 0,])
summary(lm.high)
summary(lm.low)
# high
lm.high <- lmer(vx ~ trust_6+gender + education + work_location + age+
SSS_faml+ relationship_status + (1|residing_country),
data=data.filtered[data.filtered$sd == 1,])
# low
lm.low <- lmer(vx ~ trust_6+gender + education + work_location + age+
SSS_faml+ relationship_status + (1|residing_country),
data=data.filtered[data.filtered$sd == 0,])
lm.high
lm.low
corr.test(etas,sd.trust)
corr.test(etas,sd.trust)
corr.test(etas,sd.trust)$p
lm.high
load('../Vaccine_H2.RData')
table.countries <- table(data.filtered$residing_country)
countries <- labels(table.countries)[[1]]
n.countries <- length(countries)
# test each
# frequentist
etas <- matrix(nrow=n.countries)
mean.trust <- matrix(nrow=n.countries)
sd.trust <- matrix(nrow=n.countries)
for (i in 1:n.countries){
current <- data.filtered[data.filtered$residing_country == countries[[i]],]
current.lm <- lm(vx ~ trust_6+consp+gender + education + work_location + age+
SSS_faml+ relationship_status, data=current)
current.eta<-eta_squared(current.lm)
etas[i]<-current.eta[1,2]
mean.trust[i] <- mean(current$trust_6, na.rm=T)
sd.trust[i] <- sd(current$trust_6,na.rm=T)
}
current.lm <- lm(vx ~ trust_6+consp+gender + education + work_location + age+
SSS_faml+ relationship_status, data=current)
current <- data.filtered[data.filtered$residing_country == countries[[i]],]
nrow(current)
current$consp
current.lm <- lm(vx ~ trust_6+consp+gender + education + work_location + age+
SSS_faml+ relationship_status, data=current)
i<-2
current <- data.filtered[data.filtered$residing_country == countries[[i]],]
current.lm <- lm(vx ~ trust_6+consp+gender + education + work_location + age+
SSS_faml+ relationship_status, data=current)
current.lm
i<-1
current <- data.filtered[data.filtered$residing_country == countries[[i]],]
current$consp
describe(current$consp)
nrow(current)
current.lm <- lm(vx ~ trust_6+consp+gender + education + work_location + age+
SSS_faml+ relationship_status, data=current)
etas <- matrix(nrow=n.countri
etas <- matrix(nrow=n.countri
# test each
# frequentist
etas <- matrix(nrow=n.countries)
mean.trust <- matrix(nrow=n.countries)
sd.trust <- matrix(nrow=n.countries)
for (i in 1:n.countries){
current <- data.filtered[data.filtered$residing_country == countries[[i]],]
current.lm <- lm(vx ~ trust_6+consp+gender + education + work_location + age+
SSS_faml+ relationship_status, data=current)
current.eta<-eta_squared(current.lm)
etas[i]<-current.eta[1,2]
mean.trust[i] <- mean(current$trust_6, na.rm=T)
sd.trust[i] <- sd(current$trust_6,na.rm=T)
}
etas
i<-30
current <- data.filtered[data.filtered$residing_country == countries[[i]],]
current.lm <- lm(vx ~ trust_6+consp+gender + education + work_location + age+
SSS_faml+ relationship_status, data=current)
current.lm
current.eta<-eta_squared(current.lm)
current.eta
etas
current.eta[1,2]
# test each
# frequentist
etas <- matrix(nrow=n.countries)
mean.trust <- matrix(nrow=n.countries)
sd.trust <- matrix(nrow=n.countries)
for (i in 1:n.countries){
current <- data.filtered[data.filtered$residing_country == countries[[i]],]
current.lm <- lm(vx ~ trust_6+consp+gender + education + work_location + age+
SSS_faml+ relationship_status, data=current)
current.eta<-eta_squared(current.lm)
etas[i]<-current.eta[1,2]
mean.trust[i] <- mean(current$trust_6, na.rm=T)
sd.trust[i] <- sd(current$trust_6,na.rm=T)
}
current.lm
eta_squared(current.lm)
# test each
# frequentist
etas <- matrix(nrow=n.countries)
mean.trust <- matrix(nrow=n.countries)
sd.trust <- matrix(nrow=n.countries)
for (i in 1:n.countries){
current <- data.filtered[data.filtered$residing_country == countries[[i]],]
current.lm <- lm(vx ~ trust_6+consp+gender + education + work_location + age+
SSS_faml+ relationship_status, data=current)
current.eta<-eta_squared(current.lm)
etas[i]<-current.eta[1,2]
mean.trust[i] <- mean(current$trust_6, na.rm=T)
sd.trust[i] <- sd(current$trust_6,na.rm=T)
}
i
current <- data.filtered[data.filtered$residing_country == countries[[i]],]
current.lm <- lm(vx ~ trust_6+consp+gender + education + work_location + age+
SSS_faml+ relationship_status, data=current)
nrow(current)
current$consp
current$vx
current$trust_6
corr.test(current[,c('vx','consp')])
corr.test(current[,c('vx','consp','trust_6')])
table(current$education)
table(current$work_location)
table(current$age)
table(current$relationship_status)
# test each
# frequentist
etas <- matrix(nrow=n.countries)
mean.trust <- matrix(nrow=n.countries)
sd.trust <- matrix(nrow=n.countries)
for (i in 1:n.countries){
current <- data.filtered[data.filtered$residing_country == countries[[i]],]
tryCatch( {current.lm <- lm(vx ~ trust_6+consp+gender + education + work_location + age+
SSS_faml+ relationship_status, data=current)
current.eta<-eta_squared(current.lm)
etas[i]<-current.eta[1,2]
mean.trust[i] <- mean(current$trust_6, na.rm=T)
sd.trust[i] <- sd(current$trust_6,na.rm=T)},
error=function(cond) {
etas[i]<-NA
mean.trust[i]<-NA
sd.trust[i]<-NA
}
)
}
etas
# test each
# frequentist
etas <- matrix(nrow=n.countries)
mean.trust <- matrix(nrow=n.countries)
sd.trust <- matrix(nrow=n.countries)
for (i in 1:n.countries){
current <- data.filtered[data.filtered$residing_country == countries[[i]],]
tryCatch( {current.lm <- lm(vx ~ trust_6+consp+gender + education + work_location + age+
SSS_faml+ relationship_status, data=current)
current.eta<-eta_squared(current.lm)
etas[i]<-current.eta[1,2]
mean.trust[i] <- mean(current$trust_6, na.rm=T)
sd.trust[i] <- sd(current$trust_6,na.rm=T)},
error=function(cond) {
etas[i]<-NA
mean.trust[i]<-NA
sd.trust[i]<-NA
},
warning=function(cond){
etas[i]<-NA
mean.trust[i]<-NA
sd.trust[i]<-NA
}
)
}
etas
corr.test(etas,mean.trust)
corr.test(etas,sd.trust)
sd.median <- median(sd.trust)
data.filtered$sd <- -1
# high low
for (i in 1:n.countries){
if (sd.trust[i]>=sd.median){
data.filtered[data.filtered$residing_country == countries[i],'sd'] <- 1
}else{
data.filtered[data.filtered$residing_country == countries[i],'sd'] <- 0
}
}
data.filtered$sd <- -1
# high low
for (i in 1:n.countries){
if (is.na(sd.trust[i])){
}else{
if (sd.trust[i]>=sd.median){
data.filtered[data.filtered$residing_country == countries[i],'sd'] <- 1
}else{
data.filtered[data.filtered$residing_country == countries[i],'sd'] <- 0
}}
}
is.na(sd.trust[i]
)
i
sd.trust[i]
sd.trust[i]>=sd.median
sd.median <- median(sd.trust,na.rm = T)
data.filtered$sd <- -1
# high low
for (i in 1:n.countries){
if (is.na(sd.trust[i])){
}else{
if (sd.trust[i]>=sd.median){
data.filtered[data.filtered$residing_country == countries[i],'sd'] <- 1
}else{
data.filtered[data.filtered$residing_country == countries[i],'sd'] <- 0
}}
}
table(data.filtered$sd)
# high
lm.high <- lmer(vx ~ trust_6+gender + education + work_location + age+
SSS_faml+ relationship_status + (1|residing_country),
data=data.filtered[data.filtered$sd == 1,])
# low
lm.low <- lmer(vx ~ trust_6+gender + education + work_location + age+
SSS_faml+ relationship_status + (1|residing_country),
data=data.filtered[data.filtered$sd == 0,])
# high
lm.high <- lmer(vx ~ trust_6+consp+gender + education + work_location + age+
SSS_faml+ relationship_status + (1|residing_country),
data=data.filtered[data.filtered$sd == 1,])
# low
lm.low <- lmer(vx ~ trust_6+consp+gender + education + work_location + age+
SSS_faml+ relationship_status + (1|residing_country),
data=data.filtered[data.filtered$sd == 0,])
lm.high
lm.low
corr.test(etas,mean.trust)
corr.test(etas,sd.trust)
lm.low
summary(lm.low)
summary(lm.hight)
summary(lm.high)
